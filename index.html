// どの列が目的のデータなのかを特定するヘルパー関数
    function getPostValue(post, keys) {
        if (!post || !keys) return null;
        for (const key of keys) {
            if (post[key] !== undefined) {
                return post[key];
            }
        }
        return null; // 見つからなかった場合
    }

    Papa.parse(SHEET_CSV_URL, {
        // ... (省略)
        complete: function(results) {
            const data = results.data;
            
            // ... (省略: statusMsg非表示の処理など)
            
            data.reverse().forEach(post => {
                
                // 列名が異なっても、定義したマップに基づいて値を取得
                const rawCategory = getPostValue(post, FIELD_MAP.category);
                const rawTitle = getPostValue(post, FIELD_MAP.title);
                
                // 【★変更点】タイトルがない投稿はスキップする (最低限、タイトルは必須)
                if (!rawTitle || rawTitle.trim() === '') return; 

                // ----------------------------------------------------
                // ★ 判定ロジック (変更なし)
                // ----------------------------------------------------
                const category = (rawCategory && rawCategory.trim()) ? rawCategory.trim() : 'その他';
                let catClass = 'cat-other';
                const cleanedCategory = category.toLowerCase().replace(/\s/g, '');

                if (cleanedCategory.includes('イベント')) {
                    catClass = 'cat-event';
                } else if (cleanedCategory.includes('募集')) {
                    catClass = 'cat-recruit';
                }
                
                // ----------------------------------------------------
                
                // 【★変更点】全てのデータ取得箇所で、|| ' ' (または || '') を追加し、データが空の場合に空文字列にフォールバックさせる
                const timestamp = getPostValue(post, FIELD_MAP.timestamp) || '';
                const description = getPostValue(post, FIELD_MAP.description) || ''; 
                const date = getPostValue(post, FIELD_MAP.date) || '';
                const timeStart = getPostValue(post, FIELD_MAP.timeStart) || '';
                const timeEnd = getPostValue(post, FIELD_MAP.timeEnd) || '';
                const location = getPostValue(post, FIELD_MAP.location) || '';
                const organizer = getPostValue(post, FIELD_MAP.organizer) || '';
                const email = getPostValue(post, FIELD_MAP.email) || ''; 

                // ... (省略: cardHtmlの生成とinnerHTMLへの追加)